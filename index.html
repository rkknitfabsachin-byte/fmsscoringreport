<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RK KNIT FAB â€“ Weekly Performance Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  padding:20px;
  font-family:Poppins, sans-serif;
  background:linear-gradient(135deg,#dfe9f3,#f9fcff);
}

h2{
  text-align:center;
  font-weight:600;
  margin-bottom:20px;
}

/* CARD STYLING */
.card{
  padding:15px;
  margin-bottom:12px;
  border-radius:16px;
  background:rgba(255,255,255,0.55);
  backdrop-filter:blur(8px);
  border:1px solid rgba(255,255,255,0.45);
  transition:0.25s;
}

.card:hover{
  transform:scale(1.02);
}

/* COLOR CODES */
.green{ border-left:10px solid #28a745; }
.blue{ border-left:10px solid #007bff; }
.yellow{ border-left:10px solid #ffc107; }
.orange{ border-left:10px solid #ff7f0e; }
.red{ border-left:10px solid #dc3545; }
.grey{ border-left:10px solid #6c757d; }

.step-title{
  font-size:18px;
  font-weight:600;
}

.score{
  font-size:16px;
  font-weight:500;
  margin-top:5px;
}
</style>
</head>

<body>

<h2>Weekly Performance Dashboard</h2>

<div id="cards"></div>

<canvas id="chart" style="margin-top:30px;"></canvas>

<script>

// API URL
const API = "https://script.google.com/macros/s/AKfycbxBwOJYL9OIPmsfPKE7s0teHAHp0I7svWM9ww5-_wTHlFXQN2zY7GhqQvga5tBopJcj/exec";

let fullData = [];

async function loadData(){
  fullData = await (await fetch(API)).json();
  renderCards();
  renderChart();
}

function getColor(type){
  if(type === "Early") return "green";
  if(type === "On-Time") return "blue";
  if(type === "Late") return "yellow";
  if(type === "Very Late") return "orange";
  if(type === "Overdue") return "red";
  return "grey";
}

function renderCards(){
  let html = "";

  fullData.forEach(d => {
    html += `
      <div class="card ${getColor(d.type)}">
        <div class="step-title">${d.step}</div>
        <div class="score">Score: ${d.score}</div>
        <div>Status: ${d.type}</div>
      </div>
    `;
  });

  document.getElementById("cards").innerHTML = html;
}

function renderChart(){

  const ctx = document.getElementById("chart").getContext("2d");

  const labels = fullData.map(d => d.step);
  const scores = fullData.map(d => d.score);

  new Chart(ctx, {
    type: "bar",
    data: {
      labels: labels,
      datasets: [{
        label: "Weekly Score",
        data: scores,
        borderWidth: 1
      }]
    }
  });
}

// Load data on start
loadData();

</script>

</body>
</html>
